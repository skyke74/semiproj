쿼리문만

--loc_id, amenities_id  문자 변환 쿼리문
SELECT H.hotel_id, H.hotel_name, L.loc_name, H.star_rating, H.price_per_night, H.room_count, H.contact_number,
       GROUP_CONCAT(A.amenity_name SEPARATOR ', ') AS amenities
FROM Hotels H
JOIN HotelAmenities HA ON H.hotel_id = HA.hotel_id
JOIN Amenities A ON HA.amenity_id = A.amenity_id
JOIN Location L ON H.loc_id = L.loc_id
GROUP BY H.hotel_id, L.loc_name;


--Amenities만 통합적으로 보는 쿼리문 
SELECT H.hotel_id, H.hotel_name, H.loc_id, H.star_rating, H.price_per_night, H.room_count, H.contact_number,
       GROUP_CONCAT(A.amenity_name SEPARATOR ', ') AS amenities
FROM Hotels H
JOIN HotelAmenities HA ON H.hotel_id = HA.hotel_id
JOIN Amenities A ON HA.amenity_id = A.amenity_id
GROUP BY H.hotel_id;

--최종통합 Hotels 쿼리문 
SELECT H.hotel_id, H.hotel_name, L.loc_name, H.star_rating, H.price_per_night, H.room_count, H.contact_number,
       H.address, GROUP_CONCAT(A.amenity_name SEPARATOR ', ') AS amenities, H.image_url, H.homepage_url
FROM Hotels H
JOIN HotelAmenities HA ON H.hotel_id = HA.hotel_id
JOIN Amenities A ON HA.amenity_id = A.amenity_id
JOIN Location L ON H.loc_id = L.loc_id
GROUP BY H.hotel_id, H.hotel_name, L.loc_name, H.star_rating, H.price_per_night, H.room_count, H.contact_number, H.address, H.image_url, H.homepage_url;


-- loc_id를 지역명으로 보여주게 하는 쿼리문
SELECT TA.attraction_name, L.loc_name, TA.features, TA.address, TA.homepage, TA.image_url
FROM TouristAttractions TA
JOIN Location L ON TA.loc_id = L.loc_id;